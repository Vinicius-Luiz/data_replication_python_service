2025-05-26 00:14:37,815 - INFO - TASK -  fl_cdc_scd2_employees válido
2025-05-26 00:14:37,815 - INFO - TASK - Obtendo detalhes da tabela employees.salary
2025-05-26 00:14:37,835 - DEBUG - {'schema_name': 'employees', 'table_name': 'salary', 'estimated_row_count': 2860527, 'table_size': '425 MB', 'columns': ['employee_id', 'amount', 'from_date', 'to_date']}
2025-05-26 00:14:37,835 - INFO - TASK - Obtendo detalhes da tabela employees.employee
2025-05-26 00:14:37,840 - DEBUG - {'schema_name': 'employees', 'table_name': 'employee', 'estimated_row_count': 300024, 'table_size': '39 MB', 'columns': ['id', 'birth_date', 'first_name', 'last_name', 'gender', 'hire_date']}
2025-05-26 00:14:37,840 - INFO - TASK - Obtendo detalhes da tabela employees.department_manager
2025-05-26 00:14:37,845 - DEBUG - {'schema_name': 'employees', 'table_name': 'department_manager', 'estimated_row_count': 0, 'table_size': '40 kB', 'columns': ['employee_id', 'department_id', 'from_date', 'to_date']}
2025-05-26 00:14:37,846 - INFO - TASK - Obtendo detalhes da tabela employees.department
2025-05-26 00:14:37,851 - DEBUG - {'schema_name': 'employees', 'table_name': 'department', 'estimated_row_count': 0, 'table_size': '40 kB', 'columns': ['id', 'dept_name']}
2025-05-26 00:14:37,851 - INFO - REPLICATION - Preparando employees.employee para SCD2
2025-05-26 00:14:37,851 - INFO - REPLICATION - Preparando employees.department para SCD2
2025-05-26 00:14:37,851 - INFO - REPLICATION - Preparando employees.salary para SCD2
2025-05-26 00:14:37,851 - INFO - REPLICATION - Preparando employees.department_manager para SCD2
2025-05-26 00:14:37,852 - INFO - FULL LOAD STRATEGY - Iniciando extração dos dados
2025-05-26 00:14:38,170 - INFO - ENDPOINT FACTORY - Conectando ao banco de dados Source_PostgreSQL como SOURCE
2025-05-26 00:14:38,208 - DEBUG - {'user': 'postgres', 'channel_binding': 'prefer', 'dbname': 'db_employees', 'host': 'localhost', 'port': '5432', 'options': '', 'sslmode': 'prefer', 'sslcompression': '0', 'sslcertmode': 'allow', 'sslsni': '1', 'ssl_min_protocol_version': 'TLSv1.2', 'gssencmode': 'disable', 'krbsrvname': 'postgres', 'gssdelegation': '0', 'target_session_attrs': 'any', 'load_balance_hosts': 'disable'}
2025-05-26 00:14:38,208 - INFO - TASK - Obtendo dados da tabela employees.employee
2025-05-26 00:14:38,730 - DEBUG - {'schema_name': 'employees', 'table_name': 'employee', 'rowcount': 300024, 'statusmessage': 'SELECT 300024', 'time_elapsed': '00:00:01'}
2025-05-26 00:14:38,733 - INFO - TASK - Obtendo dados da tabela employees.department
2025-05-26 00:14:38,736 - DEBUG - {'schema_name': 'employees', 'table_name': 'department', 'rowcount': 7, 'statusmessage': 'SELECT 7', 'time_elapsed': '00:00:00'}
2025-05-26 00:14:38,739 - INFO - TASK - Obtendo dados da tabela employees.salary
2025-05-26 00:14:42,302 - DEBUG - {'schema_name': 'employees', 'table_name': 'salary', 'rowcount': 2844047, 'statusmessage': 'SELECT 2844047', 'time_elapsed': '00:00:03'}
2025-05-26 00:14:42,306 - INFO - TASK - Obtendo dados da tabela employees.department_manager
2025-05-26 00:14:42,309 - DEBUG - {'schema_name': 'employees', 'table_name': 'department_manager', 'rowcount': 18, 'statusmessage': 'SELECT 18', 'time_elapsed': '00:00:00'}
2025-05-26 00:14:42,368 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-05-26 00:14:42,368 - INFO - FULL LOAD STRATEGY - Iniciando carregamento dos dados
2025-05-26 00:14:42,698 - INFO - ENDPOINT FACTORY - Conectando ao banco de dados Target_PostgreSQL como TARGET
2025-05-26 00:14:42,740 - DEBUG - {'user': 'postgres', 'channel_binding': 'prefer', 'dbname': 'db_employees_target', 'host': 'localhost', 'port': '5432', 'options': '', 'sslmode': 'prefer', 'sslcompression': '0', 'sslcertmode': 'allow', 'sslsni': '1', 'ssl_min_protocol_version': 'TLSv1.2', 'gssencmode': 'disable', 'krbsrvname': 'postgres', 'gssdelegation': '0', 'target_session_attrs': 'any', 'load_balance_hosts': 'disable'}
2025-05-26 00:14:42,749 - INFO - TRANSFORMATION - Aplicando transformação em employees.employee: Alterando nome da tabela para histórico
2025-05-26 00:14:42,749 - INFO - TRANSFORMATION - Aplicando transformação em employees.employee: Formata coluna 'first_name' com tudo em maiúsculo
2025-05-26 00:14:42,759 - INFO - TRANSFORMATION - Aplicando transformação em employees.employee: Formata coluna 'last_name' com tudo em maiúsculo
2025-05-26 00:14:42,768 - INFO - TRANSFORMATION - Aplicando transformação em employees.employee: Cria coluna 'full_name'
2025-05-26 00:14:42,781 - INFO - TRANSFORMATION - Aplicando transformação em employees.employee: Carimbar como python quem realizou a replicação dos dados
2025-05-26 00:14:42,783 - INFO - TRANSFORMATION - Aplicando transformação em employees.employee: Carimbar data de sincronização
2025-05-26 00:14:42,784 - INFO - TRANSFORMATION - Aplicando transformação em employees.employee: Criando coluna scd_start_date
2025-05-26 00:14:42,786 - INFO - TRANSFORMATION - Aplicando transformação em employees.employee: Criando coluna scd_end_date
2025-05-26 00:14:42,787 - INFO - TRANSFORMATION - Aplicando transformação em employees.employee: Criando coluna scd_current
2025-05-26 00:14:42,788 - INFO - TRANSFORMATION - Aplicando transformação em employees.employee: Adicionando chave primária scd_start_date
2025-05-26 00:14:42,788 - INFO - TASK - Realizando carga completa da tabela employees.employee_history
2025-05-26 00:14:42,788 - INFO - ENDPOINT - Removendo tabela employees.employee_history
2025-05-26 00:14:42,802 - INFO - ENDPOINT - Criando tabela employees.employee_history
2025-05-26 00:14:42,810 - INFO - ENDPOINT - Truncando tabela employees.employee_history
2025-05-26 00:14:43,200 - INFO - ENDPOINT - Inserindo 300024 registros na tabela employees.employee_history
2025-05-26 00:14:52,127 - DEBUG - {'schema_name': 'employees', 'table_name': 'employee', 'records': 300024, 'success': 1, 'time_elapsed': '00:00:09'}
2025-05-26 00:14:52,131 - INFO - TRANSFORMATION - Aplicando transformação em employees.department: Alteando nome da tabela para histórico
2025-05-26 00:14:52,131 - INFO - TRANSFORMATION - Aplicando transformação em employees.department: Criando coluna scd_start_date
2025-05-26 00:14:52,132 - INFO - TRANSFORMATION - Aplicando transformação em employees.department: Criando coluna scd_end_date
2025-05-26 00:14:52,132 - INFO - TRANSFORMATION - Aplicando transformação em employees.department: Criando coluna scd_current
2025-05-26 00:14:52,132 - INFO - TRANSFORMATION - Aplicando transformação em employees.department: Adicionando chave primária scd_start_date
2025-05-26 00:14:52,132 - INFO - TASK - Realizando carga completa da tabela employees.department_history
2025-05-26 00:14:52,132 - INFO - ENDPOINT - Removendo tabela employees.department_history
2025-05-26 00:14:52,134 - INFO - ENDPOINT - Criando tabela employees.department_history
2025-05-26 00:14:52,137 - INFO - ENDPOINT - Truncando tabela employees.department_history
2025-05-26 00:14:52,139 - INFO - ENDPOINT - Inserindo 7 registros na tabela employees.department_history
2025-05-26 00:14:52,142 - DEBUG - {'schema_name': 'employees', 'table_name': 'department', 'records': 7, 'success': 1, 'time_elapsed': '00:00:00'}
2025-05-26 00:14:52,161 - INFO - TRANSFORMATION - Aplicando transformação em employees.salary: Alterando nome da tabela para português e histórico
2025-05-26 00:14:52,161 - INFO - TRANSFORMATION - Aplicando transformação em employees.salary: Alterando nome do schema para português
2025-05-26 00:14:52,161 - INFO - TRANSFORMATION - Aplicando transformação em employees.salary: Obter diferença de anos entre o data_inicio e data_fim do salario
2025-05-26 00:14:52,183 - INFO - TRANSFORMATION - Aplicando transformação em employees.salary: Obter salário mensal
2025-05-26 00:14:52,189 - INFO - TRANSFORMATION - Aplicando transformação em employees.salary: Modificando 'employee_id' para 'funcionario_id'
2025-05-26 00:14:52,189 - INFO - TRANSFORMATION - Aplicando transformação em employees.salary: Modificando 'amount' para 'quantia_mensal'
2025-05-26 00:14:52,189 - INFO - TRANSFORMATION - Aplicando transformação em employees.salary: Modificando 'from_date' para 'data_inicio'
2025-05-26 00:14:52,189 - INFO - TRANSFORMATION - Aplicando transformação em employees.salary: Modificando 'to_date' para 'data_fim'
2025-05-26 00:14:52,189 - INFO - TRANSFORMATION - Aplicando transformação em employees.salary: Criando coluna scd_start_date
2025-05-26 00:14:52,193 - INFO - TRANSFORMATION - Aplicando transformação em employees.salary: Criando coluna scd_end_date
2025-05-26 00:14:52,199 - INFO - TRANSFORMATION - Aplicando transformação em employees.salary: Criando coluna scd_current
2025-05-26 00:14:52,202 - INFO - TRANSFORMATION - Aplicando transformação em employees.salary: Adicionando chave primária scd_start_date
2025-05-26 00:14:52,202 - INFO - TASK - Realizando carga completa da tabela funcionarios.salario_historico
2025-05-26 00:14:52,202 - INFO - ENDPOINT - Removendo tabela funcionarios.salario_historico
2025-05-26 00:14:52,204 - INFO - ENDPOINT - Criando tabela funcionarios.salario_historico
2025-05-26 00:14:52,207 - INFO - ENDPOINT - Truncando tabela funcionarios.salario_historico
2025-05-26 00:14:54,416 - INFO - ENDPOINT - Inserindo 2844047 registros na tabela funcionarios.salario_historico
2025-05-26 00:15:55,118 - DEBUG - {'schema_name': 'employees', 'table_name': 'salary', 'records': 2844047, 'success': 1, 'time_elapsed': '00:01:03'}
2025-05-26 00:15:55,123 - INFO - TRANSFORMATION - Aplicando transformação em employees.department_manager: Alterando nome da tabela para histórico
2025-05-26 00:15:55,123 - INFO - TRANSFORMATION - Aplicando transformação em employees.department_manager: Criando coluna scd_start_date
2025-05-26 00:15:55,123 - INFO - TRANSFORMATION - Aplicando transformação em employees.department_manager: Criando coluna scd_end_date
2025-05-26 00:15:55,123 - INFO - TRANSFORMATION - Aplicando transformação em employees.department_manager: Criando coluna scd_current
2025-05-26 00:15:55,123 - INFO - TRANSFORMATION - Aplicando transformação em employees.department_manager: Adicionando chave primária scd_start_date
2025-05-26 00:15:55,123 - INFO - TASK - Realizando carga completa da tabela employees.department_manager_history
2025-05-26 00:15:55,123 - INFO - ENDPOINT - Removendo tabela employees.department_manager_history
2025-05-26 00:15:55,129 - INFO - ENDPOINT - Criando tabela employees.department_manager_history
2025-05-26 00:15:55,133 - INFO - ENDPOINT - Truncando tabela employees.department_manager_history
2025-05-26 00:15:55,135 - INFO - ENDPOINT - Inserindo 18 registros na tabela employees.department_manager_history
2025-05-26 00:15:55,139 - DEBUG - {'schema_name': 'employees', 'table_name': 'department_manager', 'records': 18, 'success': 1, 'time_elapsed': '00:00:00'}
2025-05-26 00:15:55,198 - DEBUG - {'script_name': 'consumer.py', 'exit_code': 0}
2025-05-26 00:15:55,198 - INFO - FULL LOAD STRATEGY - Full Load concluído com sucesso
2025-05-26 00:15:55,203 - INFO - CDC STRATEGY - Iniciando CDC com intervalo de 3s
2025-05-26 00:15:55,546 - INFO - MESSAGE DLX - Consumer Esperando por mensagens
2025-05-26 00:15:55,612 - INFO - MESSAGE - Consumer Esperando por mensagens
2025-05-26 00:15:56,333 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-05-26 00:16:00,360 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-05-26 00:16:04,402 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-05-26 00:16:07,816 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-05-26 00:16:11,204 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-05-26 00:16:14,599 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-05-26 00:16:18,009 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-05-26 00:16:21,399 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-05-26 00:16:24,786 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-05-26 00:16:28,192 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-05-26 00:16:31,581 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-05-26 00:16:34,996 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-05-26 00:16:38,477 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-05-26 00:16:41,951 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-05-26 00:16:42,405 - INFO - CDC STRATEGY - Interrompendo processo CDC
2025-05-26 00:16:42,406 - INFO - CDC STRATEGY - CDC encerrado
2025-05-26 00:16:43,303 - INFO - FULL LOAD STRATEGY - Iniciando extração dos dados
2025-05-26 00:16:43,650 - INFO - ENDPOINT FACTORY - Conectando ao banco de dados Source_PostgreSQL como SOURCE
2025-05-26 00:16:43,686 - DEBUG - {'user': 'postgres', 'channel_binding': 'prefer', 'dbname': 'db_employees', 'host': 'localhost', 'port': '5432', 'options': '', 'sslmode': 'prefer', 'sslcompression': '0', 'sslcertmode': 'allow', 'sslsni': '1', 'ssl_min_protocol_version': 'TLSv1.2', 'gssencmode': 'disable', 'krbsrvname': 'postgres', 'gssdelegation': '0', 'target_session_attrs': 'any', 'load_balance_hosts': 'disable'}
2025-05-26 00:16:43,793 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-05-26 00:16:43,793 - INFO - FULL LOAD STRATEGY - Iniciando carregamento dos dados
2025-05-26 00:16:44,148 - INFO - ENDPOINT FACTORY - Conectando ao banco de dados Target_PostgreSQL como TARGET
2025-05-26 00:16:44,189 - DEBUG - {'user': 'postgres', 'channel_binding': 'prefer', 'dbname': 'db_employees_target', 'host': 'localhost', 'port': '5432', 'options': '', 'sslmode': 'prefer', 'sslcompression': '0', 'sslcertmode': 'allow', 'sslsni': '1', 'ssl_min_protocol_version': 'TLSv1.2', 'gssencmode': 'disable', 'krbsrvname': 'postgres', 'gssdelegation': '0', 'target_session_attrs': 'any', 'load_balance_hosts': 'disable'}
2025-05-26 00:16:44,220 - DEBUG - {'script_name': 'consumer.py', 'exit_code': 0}
2025-05-26 00:16:44,220 - INFO - FULL LOAD STRATEGY - Full Load concluído com sucesso
2025-05-26 00:16:44,225 - INFO - CDC STRATEGY - Iniciando CDC com intervalo de 3s
2025-05-26 00:16:44,562 - INFO - MESSAGE DLX - Consumer Esperando por mensagens
2025-05-26 00:16:44,624 - INFO - MESSAGE - Consumer Esperando por mensagens
2025-05-26 00:16:44,858 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-05-26 00:16:48,329 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-05-26 00:16:51,795 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-05-26 00:16:55,226 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-05-26 00:16:55,845 - INFO - CDC STRATEGY - Interrompendo processo CDC
2025-05-26 00:16:55,846 - INFO - CDC STRATEGY - CDC encerrado
