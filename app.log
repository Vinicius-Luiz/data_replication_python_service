2025-06-02 00:43:41,131 - INFO - UI - Replicação de dados iniciada
2025-06-02 00:43:41,480 - INFO - REPLICATION - Recarregando tarefa
2025-06-02 00:43:41,480 - INFO - REPLICATION - Recriando tabelas de metadata
2025-06-02 00:43:41,562 - INFO - TASK - fl_cdc_scd2_employees válido
2025-06-02 00:43:41,562 - INFO - TASK - Obtendo detalhes da tabela employees.salary
2025-06-02 00:43:41,615 - DEBUG - {'schema_name': 'employees', 'table_name': 'salary', 'estimated_row_count': 2845493, 'table_size': '425 MB', 'columns': ['employee_id', 'amount', 'from_date', 'to_date']}
2025-06-02 00:43:41,615 - INFO - TASK - Obtendo detalhes da tabela employees.employee
2025-06-02 00:43:41,620 - DEBUG - {'schema_name': 'employees', 'table_name': 'employee', 'estimated_row_count': 300024, 'table_size': '39 MB', 'columns': ['id', 'birth_date', 'first_name', 'last_name', 'gender', 'hire_date']}
2025-06-02 00:43:41,620 - INFO - TASK - Obtendo detalhes da tabela employees.department_manager
2025-06-02 00:43:41,625 - DEBUG - {'schema_name': 'employees', 'table_name': 'department_manager', 'estimated_row_count': 0, 'table_size': '40 kB', 'columns': ['employee_id', 'department_id', 'from_date', 'to_date']}
2025-06-02 00:43:41,625 - INFO - TASK - Obtendo detalhes da tabela employees.department
2025-06-02 00:43:41,630 - DEBUG - {'schema_name': 'employees', 'table_name': 'department', 'estimated_row_count': 0, 'table_size': '40 kB', 'columns': ['id', 'dept_name']}
2025-06-02 00:43:41,630 - INFO - REPLICATION - Preparando employees.employee para SCD2
2025-06-02 00:43:41,630 - INFO - REPLICATION - Preparando employees.department para SCD2
2025-06-02 00:43:41,630 - INFO - REPLICATION - Preparando employees.salary para SCD2
2025-06-02 00:43:41,630 - INFO - REPLICATION - Preparando employees.department_manager para SCD2
2025-06-02 00:43:41,635 - INFO - FULL LOAD STRATEGY - Iniciando extração dos dados
2025-06-02 00:43:41,962 - INFO - ENDPOINT FACTORY - Conectando ao banco de dados Source_PostgreSQL como SOURCE
2025-06-02 00:43:41,998 - DEBUG - {'user': 'postgres', 'channel_binding': 'prefer', 'dbname': 'db_employees', 'host': 'localhost', 'port': '5432', 'options': '', 'sslmode': 'prefer', 'sslcompression': '0', 'sslcertmode': 'allow', 'sslsni': '1', 'ssl_min_protocol_version': 'TLSv1.2', 'gssencmode': 'disable', 'krbsrvname': 'postgres', 'gssdelegation': '0', 'target_session_attrs': 'any', 'load_balance_hosts': 'disable'}
2025-06-02 00:43:41,998 - INFO - TASK - Obtendo dados da tabela employees.employee
2025-06-02 00:43:42,520 - DEBUG - {'schema_name': 'employees', 'table_name': 'employee', 'rowcount': 300024, 'statusmessage': 'SELECT 300024', 'time_elapsed': '00:00:01'}
2025-06-02 00:43:42,524 - INFO - TASK - Obtendo dados da tabela employees.department
2025-06-02 00:43:42,528 - DEBUG - {'schema_name': 'employees', 'table_name': 'department', 'rowcount': 7, 'statusmessage': 'SELECT 7', 'time_elapsed': '00:00:00'}
2025-06-02 00:43:42,532 - INFO - TASK - Obtendo dados da tabela employees.salary
2025-06-02 00:43:45,982 - DEBUG - {'schema_name': 'employees', 'table_name': 'salary', 'rowcount': 2844047, 'statusmessage': 'SELECT 2844047', 'time_elapsed': '00:00:03'}
2025-06-02 00:43:45,987 - INFO - TASK - Obtendo dados da tabela employees.department_manager
2025-06-02 00:43:45,990 - DEBUG - {'schema_name': 'employees', 'table_name': 'department_manager', 'rowcount': 18, 'statusmessage': 'SELECT 18', 'time_elapsed': '00:00:00'}
2025-06-02 00:43:46,336 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 00:43:46,336 - INFO - FULL LOAD STRATEGY - Iniciando carregamento dos dados
2025-06-02 00:43:46,661 - INFO - ENDPOINT FACTORY - Conectando ao banco de dados Target_PostgreSQL como TARGET
2025-06-02 00:43:46,702 - DEBUG - {'user': 'postgres', 'channel_binding': 'prefer', 'dbname': 'db_employees_target', 'host': 'localhost', 'port': '5432', 'options': '', 'sslmode': 'prefer', 'sslcompression': '0', 'sslcertmode': 'allow', 'sslsni': '1', 'ssl_min_protocol_version': 'TLSv1.2', 'gssencmode': 'disable', 'krbsrvname': 'postgres', 'gssdelegation': '0', 'target_session_attrs': 'any', 'load_balance_hosts': 'disable'}
2025-06-02 00:43:46,710 - INFO - TRANSFORMATION - Aplicando transformação em employees.employee: Alterando nome da tabela para histórico
2025-06-02 00:43:46,710 - INFO - TRANSFORMATION - Aplicando transformação em employees.employee: Formata coluna 'first_name' com tudo em maiúsculo
2025-06-02 00:43:46,720 - INFO - TRANSFORMATION - Aplicando transformação em employees.employee: Formata coluna 'last_name' com tudo em maiúsculo
2025-06-02 00:43:46,729 - INFO - TRANSFORMATION - Aplicando transformação em employees.employee: Cria coluna 'full_name'
2025-06-02 00:43:46,742 - INFO - TRANSFORMATION - Aplicando transformação em employees.employee: Carimbar como python quem realizou a replicação dos dados
2025-06-02 00:43:46,744 - INFO - TRANSFORMATION - Aplicando transformação em employees.employee: Carimbar data de sincronização
2025-06-02 00:43:46,745 - INFO - TRANSFORMATION - Aplicando transformação em employees.employee: Criando coluna scd_start_date
2025-06-02 00:43:46,746 - INFO - TRANSFORMATION - Aplicando transformação em employees.employee: Criando coluna scd_end_date
2025-06-02 00:43:46,747 - INFO - TRANSFORMATION - Aplicando transformação em employees.employee: Criando coluna scd_current
2025-06-02 00:43:46,748 - INFO - TRANSFORMATION - Aplicando transformação em employees.employee: Adicionando chave primária scd_start_date
2025-06-02 00:43:46,748 - INFO - TASK - Realizando carga completa da tabela employees.employee_history
2025-06-02 00:43:46,748 - INFO - ENDPOINT - Removendo tabela employees.employee_history
2025-06-02 00:43:46,766 - INFO - ENDPOINT - Criando tabela employees.employee_history
2025-06-02 00:43:46,774 - INFO - ENDPOINT - Truncando tabela employees.employee_history
2025-06-02 00:43:47,142 - INFO - ENDPOINT - Inserindo 300024 registros na tabela employees.employee_history
2025-06-02 00:43:55,705 - DEBUG - {'schema_name': 'employees', 'table_name': 'employee', 'records': 300024, 'success': 1, 'time_elapsed': '00:00:09'}
2025-06-02 00:43:55,709 - INFO - TRANSFORMATION - Aplicando transformação em employees.department: Alteando nome da tabela para histórico
2025-06-02 00:43:55,709 - INFO - TRANSFORMATION - Aplicando transformação em employees.department: Criando coluna scd_start_date
2025-06-02 00:43:55,710 - INFO - TRANSFORMATION - Aplicando transformação em employees.department: Criando coluna scd_end_date
2025-06-02 00:43:55,710 - INFO - TRANSFORMATION - Aplicando transformação em employees.department: Criando coluna scd_current
2025-06-02 00:43:55,710 - INFO - TRANSFORMATION - Aplicando transformação em employees.department: Adicionando chave primária scd_start_date
2025-06-02 00:43:55,710 - INFO - TASK - Realizando carga completa da tabela employees.department_history
2025-06-02 00:43:55,710 - INFO - ENDPOINT - Removendo tabela employees.department_history
2025-06-02 00:43:55,711 - INFO - ENDPOINT - Criando tabela employees.department_history
2025-06-02 00:43:55,715 - INFO - ENDPOINT - Truncando tabela employees.department_history
2025-06-02 00:43:55,716 - INFO - ENDPOINT - Inserindo 7 registros na tabela employees.department_history
2025-06-02 00:43:55,719 - DEBUG - {'schema_name': 'employees', 'table_name': 'department', 'records': 7, 'success': 1, 'time_elapsed': '00:00:00'}
2025-06-02 00:43:55,745 - INFO - TRANSFORMATION - Aplicando transformação em employees.salary: Alterando nome da tabela para português e histórico
2025-06-02 00:43:55,745 - INFO - TRANSFORMATION - Aplicando transformação em employees.salary: Alterando nome do schema para português
2025-06-02 00:43:55,745 - INFO - TRANSFORMATION - Aplicando transformação em employees.salary: Obter diferença de anos entre o data_inicio e data_fim do salario
2025-06-02 00:43:55,769 - INFO - TRANSFORMATION - Aplicando transformação em employees.salary: Obter salário mensal
2025-06-02 00:43:55,774 - INFO - TRANSFORMATION - Aplicando transformação em employees.salary: Modificando 'employee_id' para 'funcionario_id'
2025-06-02 00:43:55,775 - INFO - TRANSFORMATION - Aplicando transformação em employees.salary: Modificando 'amount' para 'quantia_mensal'
2025-06-02 00:43:55,775 - INFO - TRANSFORMATION - Aplicando transformação em employees.salary: Modificando 'from_date' para 'data_inicio'
2025-06-02 00:43:55,775 - INFO - TRANSFORMATION - Aplicando transformação em employees.salary: Modificando 'to_date' para 'data_fim'
2025-06-02 00:43:55,775 - INFO - TRANSFORMATION - Aplicando transformação em employees.salary: Criando coluna scd_start_date
2025-06-02 00:43:55,778 - INFO - TRANSFORMATION - Aplicando transformação em employees.salary: Criando coluna scd_end_date
2025-06-02 00:43:55,785 - INFO - TRANSFORMATION - Aplicando transformação em employees.salary: Criando coluna scd_current
2025-06-02 00:43:55,788 - INFO - TRANSFORMATION - Aplicando transformação em employees.salary: Adicionando chave primária scd_start_date
2025-06-02 00:43:55,788 - INFO - TASK - Realizando carga completa da tabela funcionarios.salario_historico
2025-06-02 00:43:55,789 - INFO - ENDPOINT - Removendo tabela funcionarios.salario_historico
2025-06-02 00:43:55,790 - INFO - ENDPOINT - Criando tabela funcionarios.salario_historico
2025-06-02 00:43:55,793 - INFO - ENDPOINT - Truncando tabela funcionarios.salario_historico
2025-06-02 00:43:57,927 - INFO - ENDPOINT - Inserindo 2844047 registros na tabela funcionarios.salario_historico
2025-06-02 00:44:58,432 - DEBUG - {'schema_name': 'employees', 'table_name': 'salary', 'records': 2844047, 'success': 1, 'time_elapsed': '00:01:03'}
2025-06-02 00:44:58,439 - INFO - TRANSFORMATION - Aplicando transformação em employees.department_manager: Alterando nome da tabela para histórico
2025-06-02 00:44:58,439 - INFO - TRANSFORMATION - Aplicando transformação em employees.department_manager: Criando coluna scd_start_date
2025-06-02 00:44:58,440 - INFO - TRANSFORMATION - Aplicando transformação em employees.department_manager: Criando coluna scd_end_date
2025-06-02 00:44:58,440 - INFO - TRANSFORMATION - Aplicando transformação em employees.department_manager: Criando coluna scd_current
2025-06-02 00:44:58,440 - INFO - TRANSFORMATION - Aplicando transformação em employees.department_manager: Adicionando chave primária scd_start_date
2025-06-02 00:44:58,440 - INFO - TASK - Realizando carga completa da tabela employees.department_manager_history
2025-06-02 00:44:58,440 - INFO - ENDPOINT - Removendo tabela employees.department_manager_history
2025-06-02 00:44:58,447 - INFO - ENDPOINT - Criando tabela employees.department_manager_history
2025-06-02 00:44:58,451 - INFO - ENDPOINT - Truncando tabela employees.department_manager_history
2025-06-02 00:44:58,453 - INFO - ENDPOINT - Inserindo 18 registros na tabela employees.department_manager_history
2025-06-02 00:44:58,458 - DEBUG - {'schema_name': 'employees', 'table_name': 'department_manager', 'records': 18, 'success': 1, 'time_elapsed': '00:00:00'}
2025-06-02 00:44:58,512 - DEBUG - {'script_name': 'consumer.py', 'exit_code': 0}
2025-06-02 00:44:58,512 - INFO - FULL LOAD STRATEGY - Full Load concluído com sucesso
2025-06-02 00:44:58,567 - INFO - TASK - fl_cdc_scd2_employees válido
2025-06-02 00:44:58,567 - INFO - TASK - Obtendo detalhes da tabela employees.salary
2025-06-02 00:44:58,611 - DEBUG - {'schema_name': 'employees', 'table_name': 'salary', 'estimated_row_count': 2845493, 'table_size': '425 MB', 'columns': ['employee_id', 'amount', 'from_date', 'to_date']}
2025-06-02 00:44:58,611 - INFO - TASK - Obtendo detalhes da tabela employees.employee
2025-06-02 00:44:58,616 - DEBUG - {'schema_name': 'employees', 'table_name': 'employee', 'estimated_row_count': 300024, 'table_size': '39 MB', 'columns': ['id', 'birth_date', 'first_name', 'last_name', 'gender', 'hire_date']}
2025-06-02 00:44:58,616 - INFO - TASK - Obtendo detalhes da tabela employees.department_manager
2025-06-02 00:44:58,621 - DEBUG - {'schema_name': 'employees', 'table_name': 'department_manager', 'estimated_row_count': 0, 'table_size': '40 kB', 'columns': ['employee_id', 'department_id', 'from_date', 'to_date']}
2025-06-02 00:44:58,621 - INFO - TASK - Obtendo detalhes da tabela employees.department
2025-06-02 00:44:58,625 - DEBUG - {'schema_name': 'employees', 'table_name': 'department', 'estimated_row_count': 0, 'table_size': '40 kB', 'columns': ['id', 'dept_name']}
2025-06-02 00:44:58,627 - INFO - REPLICATION - Preparando employees.employee para SCD2
2025-06-02 00:44:58,627 - INFO - REPLICATION - Preparando employees.department para SCD2
2025-06-02 00:44:58,627 - INFO - REPLICATION - Preparando employees.salary para SCD2
2025-06-02 00:44:58,627 - INFO - REPLICATION - Preparando employees.department_manager para SCD2
2025-06-02 00:44:58,631 - INFO - CDC STRATEGY - Iniciando CDC com intervalo de 3s
2025-06-02 00:44:59,082 - INFO - MESSAGE DLX - Consumer Esperando por mensagens
2025-06-02 00:44:59,154 - INFO - MESSAGE - Consumer Esperando por mensagens
2025-06-02 00:45:00,252 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 00:45:04,367 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 00:45:07,737 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 00:45:11,144 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 00:45:14,545 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 00:45:17,947 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 00:45:21,348 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 00:45:24,744 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 00:45:28,124 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 00:45:31,518 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 00:45:34,918 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 00:45:38,322 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 00:45:41,708 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 00:45:45,098 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 00:45:48,494 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 00:45:51,970 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 00:45:55,446 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 00:45:58,924 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 00:46:02,410 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 00:46:05,889 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 00:46:09,364 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 00:46:12,802 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 00:46:16,260 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 00:46:19,761 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 00:46:23,262 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 00:46:26,832 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 00:46:30,233 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 00:46:33,654 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 00:46:37,065 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 00:46:40,480 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 00:46:43,886 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 00:46:48,454 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 00:46:51,931 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 00:46:55,324 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 00:46:58,725 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 00:47:02,128 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 00:47:05,573 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 00:47:08,972 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 00:47:12,344 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:07:49,438 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:07:53,618 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:07:57,632 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:08:01,153 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:08:04,639 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:08:08,199 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:08:11,716 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:08:15,223 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:08:18,812 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:08:22,378 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:08:25,963 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:08:29,471 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:08:33,061 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:08:36,606 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:08:40,148 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:08:43,802 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:08:47,379 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:08:50,906 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:08:54,373 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:08:57,970 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:09:01,465 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:09:05,015 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:09:08,555 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:09:12,037 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:09:15,548 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:09:19,064 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:09:22,599 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:09:26,119 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:09:29,704 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:09:33,368 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:09:36,911 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:09:40,377 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:09:43,895 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:09:47,411 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:09:51,076 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:09:54,690 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:09:58,193 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:10:01,671 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:10:05,196 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:10:08,731 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:10:12,254 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:10:15,791 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:10:19,409 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:10:23,040 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:10:26,626 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:10:30,095 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:10:33,635 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:10:37,138 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:10:40,627 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:10:44,152 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:10:47,677 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:10:51,162 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:10:54,750 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:10:58,243 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:11:01,839 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:11:05,384 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:11:08,861 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:11:12,361 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:11:15,854 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:11:19,368 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:11:22,915 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:11:26,468 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:11:29,974 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:11:33,485 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:11:36,978 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:11:40,577 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:11:44,230 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:11:47,848 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:11:51,344 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:11:54,834 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:11:58,343 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:12:01,938 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:12:05,585 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:12:09,169 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:12:12,653 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:12:16,151 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:12:19,724 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:12:23,309 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:12:26,789 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:12:30,299 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:12:33,966 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:12:37,579 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:12:41,096 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:12:44,620 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:12:48,214 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:12:51,731 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:12:55,209 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:12:58,688 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:13:02,193 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:13:05,940 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:13:09,541 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:13:13,043 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:13:16,567 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:13:20,084 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:13:23,761 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:13:27,277 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:13:30,837 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:13:34,451 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:13:38,000 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:13:41,566 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:13:45,101 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:13:48,584 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:13:52,149 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:13:55,694 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:13:59,234 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:14:02,899 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:14:06,474 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:14:10,113 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:14:13,702 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:14:17,433 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:14:20,991 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:14:24,474 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:14:28,091 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:14:31,565 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:14:35,109 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:14:38,588 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:14:42,074 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:14:45,603 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:14:49,249 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:14:52,861 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:14:56,512 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:15:00,073 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:15:03,589 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:15:07,124 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:15:10,636 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:15:14,149 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:15:17,684 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:15:21,222 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:15:24,734 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:15:28,394 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:15:31,860 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:15:35,376 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:15:39,015 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:15:42,591 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:15:46,109 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:15:49,681 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:15:53,196 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:15:56,730 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:16:00,294 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:16:03,761 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:16:07,277 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:16:10,784 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:16:14,264 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:16:17,744 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:16:21,218 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:16:24,685 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:16:28,186 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:16:31,788 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:16:35,301 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:16:38,860 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:16:42,341 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:16:45,832 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:16:49,401 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:16:52,918 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:16:56,486 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:17:00,044 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:17:03,523 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:17:07,028 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:17:10,563 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:17:14,039 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:17:17,613 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:17:19,007 - INFO - UI - Replicação de dados finalizada
2025-06-02 01:17:41,397 - INFO - UI - Replicação de dados iniciada
2025-06-02 01:17:41,763 - INFO - REPLICATION - Recarregando tarefa
2025-06-02 01:17:41,763 - INFO - REPLICATION - Recriando tabelas de metadata
2025-06-02 01:17:42,127 - INFO - TASK - fl_cdc_scd2_employees válido
2025-06-02 01:17:42,127 - INFO - TASK - Obtendo detalhes da tabela employees.salary
2025-06-02 01:17:42,173 - DEBUG - {'schema_name': 'employees', 'table_name': 'salary', 'estimated_row_count': 2845493, 'table_size': '425 MB', 'columns': ['employee_id', 'amount', 'from_date', 'to_date']}
2025-06-02 01:17:42,173 - INFO - TASK - Obtendo detalhes da tabela employees.employee
2025-06-02 01:17:42,178 - DEBUG - {'schema_name': 'employees', 'table_name': 'employee', 'estimated_row_count': 300024, 'table_size': '41 MB', 'columns': ['id', 'birth_date', 'first_name', 'last_name', 'gender', 'hire_date']}
2025-06-02 01:17:42,179 - INFO - TASK - Obtendo detalhes da tabela employees.department_manager
2025-06-02 01:17:42,184 - DEBUG - {'schema_name': 'employees', 'table_name': 'department_manager', 'estimated_row_count': 0, 'table_size': '40 kB', 'columns': ['employee_id', 'department_id', 'from_date', 'to_date']}
2025-06-02 01:17:42,184 - INFO - TASK - Obtendo detalhes da tabela employees.department
2025-06-02 01:17:42,189 - DEBUG - {'schema_name': 'employees', 'table_name': 'department', 'estimated_row_count': 0, 'table_size': '40 kB', 'columns': ['id', 'dept_name']}
2025-06-02 01:17:42,189 - INFO - REPLICATION - Preparando employees.employee para SCD2
2025-06-02 01:17:42,189 - INFO - REPLICATION - Preparando employees.department para SCD2
2025-06-02 01:17:42,189 - INFO - REPLICATION - Preparando employees.salary para SCD2
2025-06-02 01:17:42,189 - INFO - REPLICATION - Preparando employees.department_manager para SCD2
2025-06-02 01:17:42,194 - INFO - FULL LOAD STRATEGY - Iniciando extração dos dados
2025-06-02 01:17:42,532 - INFO - ENDPOINT FACTORY - Conectando ao banco de dados Source_PostgreSQL como SOURCE
2025-06-02 01:17:42,569 - DEBUG - {'user': 'postgres', 'channel_binding': 'prefer', 'dbname': 'db_employees', 'host': 'localhost', 'port': '5432', 'options': '', 'sslmode': 'prefer', 'sslcompression': '0', 'sslcertmode': 'allow', 'sslsni': '1', 'ssl_min_protocol_version': 'TLSv1.2', 'gssencmode': 'disable', 'krbsrvname': 'postgres', 'gssdelegation': '0', 'target_session_attrs': 'any', 'load_balance_hosts': 'disable'}
2025-06-02 01:17:42,569 - INFO - TASK - Obtendo dados da tabela employees.employee
2025-06-02 01:17:43,123 - DEBUG - {'schema_name': 'employees', 'table_name': 'employee', 'rowcount': 300024, 'statusmessage': 'SELECT 300024', 'time_elapsed': '00:00:01'}
2025-06-02 01:17:43,126 - INFO - TASK - Obtendo dados da tabela employees.department
2025-06-02 01:17:43,132 - DEBUG - {'schema_name': 'employees', 'table_name': 'department', 'rowcount': 7, 'statusmessage': 'SELECT 7', 'time_elapsed': '00:00:00'}
2025-06-02 01:17:43,135 - INFO - TASK - Obtendo dados da tabela employees.salary
2025-06-02 01:17:46,996 - DEBUG - {'schema_name': 'employees', 'table_name': 'salary', 'rowcount': 2844047, 'statusmessage': 'SELECT 2844047', 'time_elapsed': '00:00:04'}
2025-06-02 01:17:46,999 - INFO - TASK - Obtendo dados da tabela employees.department_manager
2025-06-02 01:17:47,004 - DEBUG - {'schema_name': 'employees', 'table_name': 'department_manager', 'rowcount': 18, 'statusmessage': 'SELECT 18', 'time_elapsed': '00:00:00'}
2025-06-02 01:17:47,098 - DEBUG - {'script_name': 'producer.py', 'exit_code': 0}
2025-06-02 01:17:47,098 - INFO - FULL LOAD STRATEGY - Iniciando carregamento dos dados
2025-06-02 01:17:47,477 - INFO - ENDPOINT FACTORY - Conectando ao banco de dados Target_PostgreSQL como TARGET
2025-06-02 01:17:47,517 - DEBUG - {'user': 'postgres', 'channel_binding': 'prefer', 'dbname': 'db_employees_target', 'host': 'localhost', 'port': '5432', 'options': '', 'sslmode': 'prefer', 'sslcompression': '0', 'sslcertmode': 'allow', 'sslsni': '1', 'ssl_min_protocol_version': 'TLSv1.2', 'gssencmode': 'disable', 'krbsrvname': 'postgres', 'gssdelegation': '0', 'target_session_attrs': 'any', 'load_balance_hosts': 'disable'}
2025-06-02 01:17:47,539 - INFO - TRANSFORMATION - Aplicando transformação em employees.employee: Alterando nome da tabela para histórico
2025-06-02 01:17:47,539 - INFO - TRANSFORMATION - Aplicando transformação em employees.employee: Formata coluna 'first_name' com tudo em maiúsculo
2025-06-02 01:17:47,553 - INFO - TRANSFORMATION - Aplicando transformação em employees.employee: Formata coluna 'last_name' com tudo em maiúsculo
2025-06-02 01:17:47,563 - INFO - TRANSFORMATION - Aplicando transformação em employees.employee: Cria coluna 'full_name'
2025-06-02 01:17:47,578 - INFO - TRANSFORMATION - Aplicando transformação em employees.employee: Carimbar como python quem realizou a replicação dos dados
2025-06-02 01:17:47,582 - INFO - TRANSFORMATION - Aplicando transformação em employees.employee: Carimbar data de sincronização
2025-06-02 01:17:47,587 - INFO - TRANSFORMATION - Aplicando transformação em employees.employee: Criando coluna scd_start_date
2025-06-02 01:17:47,589 - INFO - TRANSFORMATION - Aplicando transformação em employees.employee: Criando coluna scd_end_date
2025-06-02 01:17:47,591 - INFO - TRANSFORMATION - Aplicando transformação em employees.employee: Criando coluna scd_current
2025-06-02 01:17:47,592 - INFO - TRANSFORMATION - Aplicando transformação em employees.employee: Adicionando chave primária scd_start_date
2025-06-02 01:17:47,592 - INFO - TASK - Realizando carga completa da tabela employees.employee_history
2025-06-02 01:17:47,593 - INFO - ENDPOINT - Removendo tabela employees.employee_history
2025-06-02 01:17:47,622 - INFO - ENDPOINT - Criando tabela employees.employee_history
2025-06-02 01:17:47,638 - INFO - ENDPOINT - Truncando tabela employees.employee_history
2025-06-02 01:17:48,009 - INFO - ENDPOINT - Inserindo 300024 registros na tabela employees.employee_history
2025-06-02 01:17:56,502 - DEBUG - {'schema_name': 'employees', 'table_name': 'employee', 'records': 300024, 'success': 1, 'time_elapsed': '00:00:09'}
2025-06-02 01:17:56,507 - INFO - TRANSFORMATION - Aplicando transformação em employees.department: Alteando nome da tabela para histórico
2025-06-02 01:17:56,507 - INFO - TRANSFORMATION - Aplicando transformação em employees.department: Criando coluna scd_start_date
2025-06-02 01:17:56,507 - INFO - TRANSFORMATION - Aplicando transformação em employees.department: Criando coluna scd_end_date
2025-06-02 01:17:56,507 - INFO - TRANSFORMATION - Aplicando transformação em employees.department: Criando coluna scd_current
2025-06-02 01:17:56,507 - INFO - TRANSFORMATION - Aplicando transformação em employees.department: Adicionando chave primária scd_start_date
2025-06-02 01:17:56,507 - INFO - TASK - Realizando carga completa da tabela employees.department_history
2025-06-02 01:17:56,507 - INFO - ENDPOINT - Removendo tabela employees.department_history
2025-06-02 01:17:56,509 - INFO - ENDPOINT - Criando tabela employees.department_history
2025-06-02 01:17:56,512 - INFO - ENDPOINT - Truncando tabela employees.department_history
2025-06-02 01:17:56,515 - INFO - ENDPOINT - Inserindo 7 registros na tabela employees.department_history
2025-06-02 01:17:56,519 - DEBUG - {'schema_name': 'employees', 'table_name': 'department', 'records': 7, 'success': 1, 'time_elapsed': '00:00:00'}
2025-06-02 01:17:56,537 - INFO - TRANSFORMATION - Aplicando transformação em employees.salary: Alterando nome da tabela para português e histórico
2025-06-02 01:17:56,537 - INFO - TRANSFORMATION - Aplicando transformação em employees.salary: Alterando nome do schema para português
2025-06-02 01:17:56,538 - INFO - TRANSFORMATION - Aplicando transformação em employees.salary: Obter diferença de anos entre o data_inicio e data_fim do salario
2025-06-02 01:17:56,570 - INFO - TRANSFORMATION - Aplicando transformação em employees.salary: Obter salário mensal
2025-06-02 01:17:56,575 - INFO - TRANSFORMATION - Aplicando transformação em employees.salary: Modificando 'employee_id' para 'funcionario_id'
2025-06-02 01:17:56,575 - INFO - TRANSFORMATION - Aplicando transformação em employees.salary: Modificando 'amount' para 'quantia_mensal'
2025-06-02 01:17:56,576 - INFO - TRANSFORMATION - Aplicando transformação em employees.salary: Modificando 'from_date' para 'data_inicio'
2025-06-02 01:17:56,576 - INFO - TRANSFORMATION - Aplicando transformação em employees.salary: Modificando 'to_date' para 'data_fim'
2025-06-02 01:17:56,576 - INFO - TRANSFORMATION - Aplicando transformação em employees.salary: Criando coluna scd_start_date
2025-06-02 01:17:56,580 - INFO - TRANSFORMATION - Aplicando transformação em employees.salary: Criando coluna scd_end_date
2025-06-02 01:17:56,585 - INFO - TRANSFORMATION - Aplicando transformação em employees.salary: Criando coluna scd_current
2025-06-02 01:17:56,589 - INFO - TRANSFORMATION - Aplicando transformação em employees.salary: Adicionando chave primária scd_start_date
2025-06-02 01:17:56,589 - INFO - TASK - Realizando carga completa da tabela funcionarios.salario_historico
2025-06-02 01:17:56,589 - INFO - ENDPOINT - Removendo tabela funcionarios.salario_historico
2025-06-02 01:17:56,590 - INFO - ENDPOINT - Criando tabela funcionarios.salario_historico
2025-06-02 01:17:56,595 - INFO - ENDPOINT - Truncando tabela funcionarios.salario_historico
2025-06-02 01:17:58,568 - INFO - UI - Replicação de dados finalizada
